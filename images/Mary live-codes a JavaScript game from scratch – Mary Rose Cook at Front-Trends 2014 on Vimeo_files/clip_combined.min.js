function google_ad_request_done(a){var b=a.length;if(!(0>=b)&&$("google_afc_ads")){var c="";for(i=0;i<b;i++)c+='<a href="'+a[i].url+'" style="text-decoration:none"><span class="line_1">'+a[i].line1+'</span><span class="line_2">'+a[i].line2+" "+a[i].line3+'</span><span class="line_3">'+a[i].visible_url+"</span></a>";c?$("google_afc_ads").set("html","<h4>Sponsored Links</h4>"+c).addClass("ad-loaded"):$("google_afc_ads").dispose()}}!function(a){var b,c,d,e,f,g=a.document,h=Math,i=(a.setTimeout,"getContext"in g.createElement("canvas")),j=function(a,b){a=a||{};for(var c in b)a[c]=b[c];return a},k=function(b){if(!i)return{rgb:!1,alpha:1};var c,d=g.createElement("i");return d.style.display="none",d.style.color=b,g.body.appendChild(d),c=a.getComputedStyle(d,null).getPropertyValue("color").replace(/^rgba?\(([^\)]+)\)/,"$1").replace(/\s/g,"").split(",").splice(0,4),g.body.removeChild(d),d=null,{alpha:4==c.length?c.pop():1,rgb:c}},l=function(a,b,c){var d=c?-2:2;a.translate(b/d,b/d)},m=function(a,g,i,j){b=1-a||0,e=1,f=-1;var k=g.size;for(g.clockwise===!1&&(e=-1,f=1),i.clearRect(0,0,k,k),i.globalAlpha=g.alpha,i.lineWidth=g.strokewidth,c=0;c<g.lines;c++)d=c+j>=g.lines?c-g.lines+j:c+j,i.strokeStyle="rgba("+g.color.join(",")+","+h.max(0,d/(g.lines-b))+")",i.beginPath(),i.moveTo(k/2,k/2-g.padding/2),i.lineTo(k/2,0),i.stroke(),l(i,k,!1),i.rotate(e*(360/g.lines)*h.PI/180),l(i,k,!0);g.rotationspeed&&(i.save(),l(i,k,!1),i.rotate(f*(360/g.lines/(20-2*g.rotationspeed))*h.PI/180),l(i,k,!0))};Throbber=function(b){var c=this.elem=g.createElement("canvas"),d=this;isNaN(b)||(b={size:b}),this.o={size:34,rotationspeed:6,clockwise:!0,color:"#fff",fade:300,fallback:!1,alpha:1},this.configure(b),this.phase=-1,i?(this.ctx=c.getContext("2d"),c.width=c.height=this.o.size):this.o.fallback&&(c=this.elem=new Image,c.src=this.o.fallback),this.loop=function(){var b=d.o,e=0,f=1e3/b.fade/b.fps,g=(1e3/b.fps,d.step),j=c.style,k=c.currentStyle,l=(k&&k.filter||j.filter,"filter"in j&&b.fallback&&!i);return function(){3==d.phase&&(e-=f,0>=e&&(d.phase=0)),1==d.phase&&(e+=f,e>=1&&(d.phase=2)),l?j.filter="alpha(opacity="+h.min(100*b.alpha,h.max(0,Math.round(100*e)))+")":!i&&b.fallback?j.opacity=e:i&&(m(e,b,d.ctx,g),g=0===g?d.o.lines:g-1),a.setTimeout(d.loop,1e3/b.fps)}}()},Throbber.prototype={constructor:Throbber,appendTo:function(a){return this.elem.style.display="none",a.appendChild(this.elem),this},configure:function(b){var c,d=this.o;return j(d,b||{}),c=k(d.color),j(d,j({padding:d.size/2,strokewidth:h.max(1,h.min(d.size/30,3)),lines:h.min(30,d.size/2+4),alpha:c.alpha||1,fps:h.min(30,d.size+4)},b)),d.color=c.rgb,this.step=d.lines,a.devicePixelRatio&&(this.elem.style.width=d.size+"px",this.elem.style.height=d.size+"px",d.size*=2,d.padding*=2,d.strokewidth*=2),this},start:function(){return this.elem.style.display="block",-1==this.phase&&this.loop(),this.phase=1,this},stop:function(){return this.phase=3,this},toggle:function(){2==this.phase?this.stop():this.start()}}}(this);var Brozar=new Class({Implements:[Options,Events],options:{url:null,stream_id:null,stream_position:null,container_width:null,promo_videos:0,thumbnail_width:180,width_buffer:110,recommendation_algorithm:null,onClipSelected:function(){}},fragment_cache:new Hash,url_cache_map:new Hash,stream_id:null,page_number:1,items_per_page:10,item_offset:null,scroll_direction:null,scroll_active:!1,recommendation_algorithm:null,RESIZE_UPDATE_INTERVAL:500,initialize:function(a,b){var c=this;if(c.container=$(a),c.loaded=!1,null===c.container)throw new Error("Invalid element supplied to Brozar");c.setOptions(b),c.attachEvents(),c.setInitialValues(),c.request=new Request.HTML({method:"get",onSuccess:function(a,b,d,e){var f,g;c.processHtml(d),g=$("streams").getElement(".stream.active.js-recent-stream"),g||c.fragment_cache.set(c.getKey(),d),c.loaded||Signal.brozar.initialize.dispatch(f),c.loaded=!0}}),c.loadPage()},attachEvents:function(){var a=this;a.bound={onWindowResize:a.onWindowResize.bind(a)},window.addEvent("resize:pause("+a.RESIZE_UPDATE_INTERVAL+")",a.bound.onWindowResize),History.addEvent("change",a.onHistoryChange.bind(a)),a.container.addEvent("click:relay(a)",a.onBrozarClick.bind(a)),a.container.addEvent("change:relay(select)",a.onStreamUpdate.bind(a)),a.container.addEvent("swipe:relay(#clips)",a.onBrozarSwipe.bind(a))},setInitialValues:function(){this.last_container_width=this.options.container_width||this.container.getSize().x,this.items_per_page=this.calculateItemsPerPage(),this.last_list_width=this.items_per_page*this.options.thumbnail_width,this.stream_id=this.options.stream_id,this.recommendation_algorithm=this.options.recommendation_algorithm;var a=this.options.stream_position;a&&this.setPage(Math.floor(a/this.items_per_page)+1)},resetStreamCalculations:function(){this.setPage(1),this.scroll_direction=null,this.item_offset=null},calculateItemsPerPage:function(){var a=this.last_container_width,b=a-this.options.width_buffer,c=b/this.options.thumbnail_width;return c=c%1>.9?Math.ceil(c):Math.floor(c),c-=this.options.promo_videos,Math.max(c,1)},setPage:function(a){if(a=parseInt(a,10),!a||1>a)throw new Error("Brozar page was not set");this.page_number=a},getPage:function(){return this.page_number},getKey:function(){var a=this.stream_id,b=$("streams"),c=this.getPage();return null!==a?a+":"+c:null!==b?b.get("data-stream")+":"+c:c},loadPage:function(){var a=this,b=a.fragment_cache.get(a.getKey()),c=a.getPage(),d=$("js-clips_wrapper");return null!==b?void a.processHtml(b):(null!==d&&d.addClass("loading"),void a.request.send({url:window.location.pathname,data:{action:"brozar",stream:a.stream_id,page:c,page_size:a.items_per_page,offset:a.item_offset,recommendation_algorithm:a.recommendation_algorithm}}))},setClipPositions:function(){var a=$("clips");null!==a&&(this.purgeData(a),a.setStyles({"-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:"",left:0}))},purgeData:function(a){var b=a.getChildren(),c=this.items_per_page,d=this.scroll_direction;b.each(function(a,b){return"left"===d&&b>c+1?void a.destroy():"right"===d&&c>b?void a.destroy():void 0}.bind(this))},setActiveClip:function(){var a=$$("[data-clip-id="+vimeo.config.clip.id+"]"),b=$$(".js-brozar_clips_item");null!==a&&(b.removeClass("selected"),a.getParent().addClass("selected"))},processHtml:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=$("streams"),p=$("clips"),q=$$(".js-clip_placeholder_item"),r=$("js-clips_wrapper"),s=[];if(null===this.scroll_direction)this.container.set("html",a),this.setClipPositions(),null===o||Browser.ie||(b=$("streams"),d=o.getElement(".couchmode"),f=o.getElement(".seeall"),c=b.get("data-stream"),e=b.getElement(".couchmode"),g=b.getElement(".seeall"),o.replaces(b),o.set("data-stream",c),null!==d&&d.destroy(),null!==f&&f.destroy(),null!==g&&g.inject(o,"top"),null!==e&&e.inject(o,"top")),null!==p&&this.setPage(p.get("data-page"));else{if(h=$("arrow_left"),i=$("arrow_right"),j=Elements.from(a),j=$(j[0]).getChildren(),j[2].replaces(h),j[3].replaces(i),k=j[1].getFirst().getChildren(),l=k.length,j=null,"left"===this.scroll_direction)for(m=0;l-1>m;m++)k[m].replaces(q[m]);else for(m=1;l>m;m++)k[m].replaces(q[m-1]);q.destroy(),k=null}if(this.setActiveClip(),p)try{p.getFirst().getElement("a").focus()}catch(t){}null!==r&&r.removeClass("loading"),setTimeout(function(){this.container.getElements(".js-brozar_clips_item").each(function(a){var b=a.getElement("a"),c=b.get("data-clip-id").toString(),d=b.get("data-type"),e=b.hasClass("js-promo_link"),f={};f={t:d,p:e,clip_id:c},s.push(f)}),null===n.stream_id&&(n.stream_id=this.container.getElement("div[id=streams]").get("data-stream")),new Request({url:window.location.pathname,method:"post",data:{action:"log_promo_impression",cids:JSON.stringify(s),page:n.page_number,page_size:n.items_per_page,stream:n.stream_id,recommendation_algorithm:n.recommendation_algorithm,token:vimeo.xsrft},onSuccess:function(){s=[]}}).send()}.bind(n),2e3)},scroll:function(){var a,b=$("clips"),c=this.last_list_width,d="left"===this.scroll_direction?0:-c,e=new Fx.Tween.CSS3(b,{unit:"px",property:"left",duration:350,transition:"quint:out",onComplete:function(){this.setClipPositions.apply(this,arguments),this.scroll_active=!1}.bind(this)});a=new Element("li",{html:'<span class="thumbnail thumbnail_med_wide"></span><div class="data"><p class="title">&nbsp;</p><p class="meta">&nbsp;</p></div>',"class":"js-clip_placeholder_item brozar_clips_item"}),"left"===this.scroll_direction&&b.setStyle("left",-c+"px");for(var f=0;f<this.items_per_page;f++)a.clone().inject(b,"left"===this.scroll_direction?"top":"bottom");e.start(d)},whLogBrozarClick:function(a,b,c,d,e){var f=this,g=b||"other",h=c||null;new Request({url:window.location.pathname,method:"post",data:{action:"log_onsite_click",type:"brozar-"+g,clip_id:a,item_position:h,page:f.page_number,page_size:f.items_per_page,promoted:e===!0?1:0,stream:f.stream_id,recommendation_algorithm:f.recommendation_algorithm,token:vimeo.xsrft},onSuccess:function(){d&&(window.location=d)}.bind(f)}).send(),Cookie.write("play_log_ref",["brozar-"+b,a.toString()].join(":"))},onWindowResize:function(){var a=this.container.getWidth();a!==this.last_container_width&&(this.fragment_cache.empty(),this.url_cache_map.empty(),this.last_container_width=a,this.items_per_page=this.calculateItemsPerPage(),this.last_list_width=this.items_per_page*this.options.thumbnail_width,this.resetStreamCalculations(),this.loadPage())},onBrozarClick:function(a,b){var c=".js-brozar_clips_item",d=b.getParent(c);if(d&&d.hasClass("selected")||b.hasClass("active"))return void a.stop();if(!b.hasClass("more"))return d?void this.onClipClick(a,b):b.getParent(".scroll")?void this.onPaginationClick(a,b):b.getParent("#streams")?void this.onStreamUpdate(a,b):void 0},onBrozarSwipe:function(a){var b={left:"right",right:"left"},c=a.direction,d=$$("#arrow_"+b[c]+" a");d[0]&&this.onPaginationClick(a,d[0],b[c])},onClipClick:function(a,b){var c=this,d=$("streams").get("data-stream"),e=b.get("href"),f=+(b.get("data-clip-id")||b.getParent().get("data-clip-id")),g=b.get("data-type")||"other",h=$$("#clips li").indexOf($("clip_"+f)),i=+b.get("data-clip-position")||1,j=".js-brozar_clips_item",k=b.getParent(j),l="1"===b.get("data-bypass"),m=k.getElement(".js-user_name"),n=$("streams").getElement(".js-user_stream"),o=b.get("data-user-stream"),p=$("streams").getElement(".js-recommended_stream"),q=b.get("data-recommended-stream");if(l||this.fireEvent("onClipSelected",[e]),b.hasClass("js-promo_link")?c.whLogBrozarClick(f,g,c.items_per_page+i,l?b.href:!1,!0):c.whLogBrozarClick(f,g,h+1),!l){if(a.shift||a.control||a.alt||a.meta||1!==a.event.which)return!0;if(this.stream_id=d,a.stop(),$$(j).removeClass("selected"),k.addClass("selected"),m&&n){var r=Copy.translate("owner_videos",!1,{USER_NAME:m.textContent});n.innerHTML=r,n.set("data-stream",o)}return p&&p.set("data-stream",q),b.hasClass("js-reccommended")?(this.resetStreamCalculations(),this.stream_id=q,void this.loadPage()):b.hasClass("js-promo_link")?(this.resetStreamCalculations(),this.stream_id=o,void this.loadPage()):void(h===c.items_per_page&&c.container.getElement(".arrow_right").getElement("a").click())}},onPaginationClick:function(a,b,c){a.stop(),this.scroll_active||(this.scroll_active=!0,this.setPage(b.get("data-page")),this.scroll_direction=c||(b.getParent().hasClass("arrow_left")?"left":"right"),this.item_offset=b.get("data-offset")||null,this.scroll(),this.loadPage())},onStreamUpdate:function(a,b){a.stop();var c,d=b.getParent().getElements(".stream");this.resetStreamCalculations(),d.length?(d.removeClass("active"),b.addClass("active"),c=b.get("data-stream")):c=b.options[b.selectedIndex].value,this.stream_id=c,this.loadPage()},onHistoryChange:function(a,b,c){var d=this,e=c.href,f=d.getKey(),g=d.url_cache_map.get(e),h=d.fragment_cache.get(g);if(History.hasPushState())return g?void(h&&(d.container.set("html",h),d.resetStreamCalculations(),d.setClipPositions())):void d.url_cache_map.set(e,f)}});!function(){"use strict";var a=new Class({Implements:[Options],options:{max_height:170},link_buffer_height:50,initialize:function(a,b){var c=this;if(null===$(a))throw new Error("Invalid element supplied to ReadMore");c.setOptions(b),c.container=a,c.container_height=c.container.scrollHeight,c.createElements(),c.attachEvents()},createElements:function(){var a=this;a.needCollapsedState()&&a.setCollapsedState()},attachEvents:function(){var a=this;a.container_wrapper&&a.container_wrapper.addEvent("click:once",a.onContainerClick.bind(a))},createReadMoreElement:function(){var a=this,b=a.container.get("data-expand-tooltip")||"Click to expand";return new Element("div",{"class":"more_link collapsed faux_link js-read_more_link",html:Copy.dict.read_more+"&hellip;",title:b})},createWrapper:function(){return new Element("div",{"class":"js-read_more_wrapper"})},needCollapsedState:function(){var a=this;return a.options.max_height+a.link_buffer_height<a.container_height},setCollapsedState:function(){var a=this;a.read_more_link=a.createReadMoreElement(),a.container_wrapper=a.createWrapper(),a.container.setStyle("height",a.options.max_height),a.container.addClass("read_more collapsed"),a.container_wrapper.wraps(a.container),a.container_wrapper.grab(a.read_more_link),a.container_wrapper.setStyle("cursor","pointer")},onContainerClick:function(){var a=this;a.container.hasClass("collapsed")&&(a.container.removeClass("collapsed"),a.read_more_link.removeClass("collapsed"),a.container.setStyle("height",a.container_height),a.container_wrapper.setStyle("cursor","auto"))}});window.ReadMore=a}(),function(){"use strict";var a=new Class({initialize:function(){var a=this;a.createElements(),a.attachEvents()},createElements:function(){var a=this,b=$$(".js-extras")[0],c=$$("#brozar")[0],d=c?c.getSize().y:0;a.scroll_spy=new ThrottledScrollSpy({min:b.getPosition().y-d-window.getSize().y,onEnter:a.onScrollSpyEnter.bind(a)})},attachEvents:function(){},onScrollSpyEnter:function(){var a=this;a.scroll_spy.stop(),Signal.clip.extras.scroll_spy.entered.dispatch()},onClipChanged:function(){var a=this;a.scroll_spy.start()}});window.ClipExtrasScrollSpy=a}(),function(){"use strict";var a=new Class({REQUEST_TIMEOUT:1e4,is_loaded:!1,initialize:function(){var a=this;a.createElements(),a.createRequests(),a.attachEvents()},createElements:function(){var a=this;a.module_container=$$(".js-extras-wrapper")[0],a.extras_container=$$(".js-extras")[0],a.load_indicator=a.module_container.getElement(".js-extras-load-indicator"),a.retry_notice=a.module_container.getElement(".js-extras-retry"),a.retry_btn=a.retry_notice.getElement(".js-extras-retry-btn"),"undefined"!=typeof Throbber&&(a.throbber=new Throbber({size:32,padding:18,color:"#d3d3d3",strokewidth:2,lines:15}),$(a.throbber.elem).addClass("throbber").inject(a.load_indicator.getElement(".js-loading-text"),"top"),a.throbber.start())},createRequests:function(){var a=this;a.extras_request=new Request.HTML({method:"get",data:{action:"extras"},update:a.extras_container,link:"cancel",timeout:a.REQUEST_TIMEOUT,onRequest:a.onRequestStart.bind(a),onSuccess:a.onRequestSuccess.bind(a),onFailure:a.onRequestFailure.bind(a),onTimeout:a.onRequestTimeout.bind(a)})},attachEvents:function(){var a=this;a.retry_btn.addEvent("click",a.onRetryClick.bind(a)),Signal.clip.changed.add(a.onClipChanged.bind(a)),Signal.clip.extras.scroll_spy.entered.add(a.onScrollSpyEnter.bind(a))},showLoadIndicator:function(){var a=this;a.load_indicator.removeClass("hide")},hideLoadIndicator:function(){var a=this;a.load_indicator.addClass("hide")},showRetryLink:function(){var a=this;a.retry_notice.removeClass("hide")},hideRetryLink:function(){var a=this;a.retry_notice.addClass("hide")},adoptAds:function(){var a=this,b=$("google_afc_ads");b&&a.extras_container.getElement(".col_large").adopt(b,"bottom")},stashAds:function(){var a=this,b=$("google_afc_ads");b&&a.module_container.adopt(b,"bottom")},onScrollSpyEnter:function(){var a=this;a.load()},onClipChanged:function(){var a=this;a.load()},onRetryClick:function(a){var b=this;b.load(),a.preventDefault(a)},onRequestStart:function(){var a=this;a.is_loaded=!1,a.showLoadIndicator(),a.hideRetryLink(),a.extras_container.removeClass("clearfix"),Signal.clip.extras.loading.dispatch()},onRequestSuccess:function(){var a=this;a.is_loaded=!0,a.hideLoadIndicator(),a.hideRetryLink(),a.extras_container.addClass("clearfix"),a.adoptAds(),Signal.clip.extras.loaded.dispatch()},onRequestFailure:function(){var a=this;a.showRetryLink(),Signal.clip.extras.failed.dispatch()},onRequestTimeout:function(){var a=this;a.showRetryLink(),Signal.clip.extras.timed_out.dispatch()},reset:function(){var a=this,b=a.extras_request;b.isRunning()&&b.cancel(),a.stashAds(),a.extras_container.empty()},load:function(a){var b,c,d=this,e=document.location.pathname;if(d.reset(),a){if("number"!=typeof a||a%1!==0)throw new Error("Non-integer value passed to ClipExtrasModule.load()");b=e.test("/pwnd")?"/pwnd":"",c="/"+a+b}else c=e;d.extras_request.send({url:c})}});window.ClipExtrasMain=a}(),function(){"use strict";var a=new Class({initialize:function(){var a=this;a.credits_container=$$("#credits_extras")[0],a.credits_container&&(a.remove_credit_element=a.credits_container.getElement(".js-remove-credit"),a.remove_credit_element&&(a.credit_element=a.remove_credit_element.getParents("[data-credit-id]")[0],a.createRequests(),a.attachEvents()))},createRequests:function(){var a=this;a.remove_request=new Request.HTML({url:vimeo.config.clip.url,method:"post",data:{token:vimeo.xsrft,action:"toggle_clip_credits",credit_id:a.credit_element.get("data-credit-id")},update:a.credits_container,link:"cancel",onRequest:a.onRequestStart.bind(a),onFailure:a.onRequestFailure.bind(a)})},attachEvents:function(){var a=this;a.bound_events={onRemoveClick:a.onRemoveClick.bind(a)},a.remove_credit_element.addEvent("click",a.bound_events.onRemoveClick)},destroy:function(){var a=this;a.remove_credit_element&&a.remove_credit_element.removeEvent("click",a.bound_events.onRemoveClick)},onRemoveClick:function(a){var b=this,c=Copy.dict.confirm_remove_credit||"Are you sure?";confirm(c)&&b.removeCredit(),a.preventDefault()},onRequestStart:function(){var a=this;a.credit_element.addClass("hide")},onRequestFailure:function(){var a=this,b="Oops!",c="We’re having some technical difficulties right now. Please try again later.";try{Singletonbox.alert(b,c)}catch(d){alert(c)}a.credit_element.removeClass("hide")},removeCredit:function(){var a=this;if(!a.remove_credit_element)throw new Error("Missing credit element for the current user at ClipExtrasCredits.removeCredit()");a.remove_request.send()}});window.ClipExtrasCredits=a}(),function(){"use strict";var a=new Class({REFRESH_THRESHOLD:6e5,REFRESH_INTERVAL:3e4,initialize:function(){var a=this;a.createElements(),a.attachEvents(),a.createRequests(),a.getInitialCounts()},createElements:function(){var a=this;a.bound_events={onRequestSuccess:a.onRequestSuccess.bind(a),onRequestFailure:a.onRequestFailure.bind(a),onClipLike:a.onClipLike.bind(a),onClipUnlike:a.onClipUnlike.bind(a)},a.likes_container=$$("#likes_extras"),a.header=a.likes_container.getElement(".js-likes_header")[0],a.user_likes_container=a.likes_container.getElement(".people")[0],a.user_like_template=a.createLikeTemplate()},createRequests:function(){var a=this;a.likes_request=new Request.HTML({method:"get",update:"likes_extras",onSuccess:a.bound_events.onRequestSuccess,onFailure:a.bound_events.onRequestFailure}),a.checkForRefresh()},attachEvents:function(){Signal.player.like.add(this.bound_events.onClipLike),Signal.player.unlike.add(this.bound_events.onClipUnlike)},checkForRefresh:function(){var a=this;if(a.user_likes_container.getChildren().length){var b,c,d,e,f,g=(new Date).getTime(),h=a.user_likes_container.getFirst().getElement("time"),i=a.user_likes_container.getLast().getElement("time");h&&i&&(b=new Date(h.get("datetime")).getTime(),c=new Date(i.get("datetime")).getTime(),d=Math.floor((g-b)/1e3),e=Math.floor((g-c)/1e3),f=e-d,e<a.REFRESH_THRESHOLD&&f<a.REFRESH_THRESHOLD&&setTimeout(function(){a.refresh(vimeo.config.clip.id)},a.REFRESH_INTERVAL))}},getInitialCounts:function(){var a=this;a.total_likes=parseInt(a.likes_container.get("data-total-likes"),10),a.displayed_likes=a.user_likes_container.getChildren().length,a.max_displayed_likes=parseInt(a.likes_container.get("data-max-displayed-likes"),10)},createLikeTemplate:function(){var a,b=this,c=$$("#user_like_template")[0];return c?(a=c.clone().set("id",null).removeClass("hide"),c.destroy()):a=b.user_likes_container.getFirst().clone(),a},createLikeElement:function(a){var b,c=this;if(c.user_like_template)return b=c.user_like_template.clone(),b.getElement("> a").set("href",a.url).set("title",a.display_name),b.getElement(".portrait").set("src",a.image_url[30]),b.getElement(".portrait").set("srcset",a.image_url[60]+" 2x"),b.getElement(".user_name").set("text",a.display_name),b.getElement(".meta > time").set("text",Copy.dict.just_now).set("datetime",new Date),b},getLikeElement:function(a){return this.user_likes_container.getElement('[data-id="'+a+'"]')},addUserLike:function(){var a,b=this,c=new Date;vimeo.cur_user&&(b.cached_current_like_el?(a=b.cached_current_like_el,a.getElement("time").set("datetime",c.toISOString()).set("title",c.toString()).set("text",Copy.dict.just_now)):a=b.cached_current_like_el=b.createLikeElement(vimeo.cur_user),a.inject(b.user_likes_container,"top").addClass("fadeIn").addClass("animated"),b.displayed_likes+1>b.max_displayed_likes&&(b.cached_last_like_el=b.user_likes_container.getLast().dispose()),b.incrementTotalLikes())},removeUserLike:function(){var a,b=this;vimeo.cur_user&&(a=b.cached_current_like_el||b.getLikeElement(vimeo.cur_user.id),a&&a.dispose(),b.cached_last_like_el?(b.cached_last_like_el.inject(b.user_likes_container,"bottom"),b.decrementTotalLikes()):b.refresh(vimeo.config.clip.id))},incrementTotalLikes:function(){var a=this;return a.updateDisplayCount(++a.total_likes),a.likes_container.hasClass("hide")&&a.likes_container.removeClass("hide"),a.total_likes},decrementTotalLikes:function(){var a=this;return a.total_likes=Math.max(0,--a.total_likes),0!==a.total_likes?a.updateDisplayCount(a.total_likes):a.likes_container.addClass("hide"),a.total_likes},updateDisplayCount:function(a){var b=this,c=Math.max(0,a).formatBigNumber();b.header.set("text",Copy.translate("likes_count",!1,{COUNT:c}))},onClipLike:function(){var a=this;a.likes_container&&a.addUserLike()},onClipUnlike:function(){var a=this;a.likes_container&&a.removeUserLike()},onRequestSuccess:function(){var a=this;a.cached_last_like_el=null,a.cached_current_like_el=null,a.checkForRefresh()},onRequestFailure:function(){},refresh:function(a){var b=this;if(!a)throw new Error("clip_id not specified!");b.likes_request.send({data:{action:"likes_extras",clip_id:a,is_refresh:!0}})}});window.ClipExtrasLikes=a}();var BaseCarousel=new Class({Implements:[Options,Events],options:{container:null,active_class:"active",autoplay:!0,autoplay_delay:1e4,infinite:!0},initialize:function(a){var b,c=this;c.setOptions(a),b=c.options,c.current_index=0,c.container=$(b.container),c.slides=c.container.getChildren(),c.slides[0].addClass(b.active_class),b.autoplay&&c.play()},getCurrentIndex:function(){var a=this,b=0+a.current_index;return b},getPreviousIndex:function(){var a=this,b=a.current_index-1,c=a.slides,d=c.length,e=d-1,f=a.options.infinite;return 0>b&&(b=f?e:0),b},getNextIndex:function(){var a=this,b=a.current_index+1,c=a.slides,d=c.length,e=d-1,f=a.options.infinite;return b>e&&(b=f?0:e),b},play:function(){var a=this;a.interval=setInterval(a.next.bind(a),a.options.autoplay_delay)},pause:function(){var a=this;clearInterval(a.interval)},show:function(a){var b=this,c=b.slides;b.current_index=a,c.removeClass("active"),c[a].addClass("active"),b.fireEvent("change",{index:b.current_index,slides:c})},previous:function(){var a=this;a.show(a.getPreviousIndex())},next:function(){var a=this;a.show(a.getNextIndex())}}),PagedCarousel=new Class({Extends:BaseCarousel,options:{previous_button:null,next_button:null,page_buttons:null},initialize:function(a){var b,c=this;c.parent(a),b=c.options,c.previous_button=$(b.previous_button),c.next_button=$(b.next_button),c.page_buttons=$$(b.page_buttons),c.page_buttons.length&&c.page_buttons[0].addClass(b.active_class),c.attachEvents()},attachEvents:function(){var a=this;a.page_buttons&&a.page_buttons.addEvent("click",a.onPageClick.bind(this)),a.previous_button&&a.previous_button.addEvent("click",a.onPreviousClick.bind(this)),a.next_button&&a.next_button.addEvent("click",a.onNextClick.bind(this))},onPageClick:function(a){var b=this,c=b.page_buttons.indexOf(a.target);b.show(c),clearInterval(b.interval),a.preventDefault()},onPreviousClick:function(a){var b=this;b.previous(),clearInterval(b.interval),a.preventDefault()},onNextClick:function(a){var b=this;b.next(),clearInterval(b.interval),a.preventDefault()},show:function(a){var b=this,c=b.slides,d=c.length,e=d-1,f=(b.options.infinite,b.page_buttons),g=b.previous_button,h=b.next_button;b.parent(a),b.options.infinite||(0===b.current_index?g.addClass("disabled"):g.removeClass("disabled"),b.current_index===e?h.addClass("disabled"):h.removeClass("disabled")),f.length&&(f.removeClass(b.options.active_class),f[b.current_index].addClass(b.options.active_class))}});!function(){"use strict";var a=new Class({initialize:function(){var a=this;if("undefined"==typeof PagedCarousel)throw new Error("PagedCarousel class not found at ClipExtrasStills.initialize()");a.createElements()},createElements:function(){var a=this;a.clip_stills_list=$$(".js_clip_stills_list")[0],a.carousel_container=$$(".carousel_container")[0],a.clip_stills_list&&a.carousel_container&&(a.attachEvents(),a.createCarousel())},attachEvents:function(){var a=this;a.carousel_container&&(a.bound_events={onThumbnailHover:a.onThumbnailHover.bind(a),onThumbnailMouseDown:a.onThumbnailMouseDown.bind(a),onThumbnailMouseUp:a.onThumbnailMouseUp.bind(a)})},destroy:function(){var a,b,c=this;c.carousel_container&&(a=c.carousel_page_buttons,b=c.carousel_container,a.removeEvent("mouseover",c.bound_events.onThumbnailHover),b.removeEvent("mousedown",c.bound_events.onThumbnailMouseDown),b.removeEvent("mouseup",c.bound_events.onThumbnailMouseUp))},createCarousel:function(){var a,b=this,c=b.carousel_container;a=b.carousel_page_buttons=b.clip_stills_list.getElements("[data-large-image]"),a.addEvent("mouseover",b.bound_events.onThumbnailHover),a.each(b.createCarouselPage,b),b.carousel_component=new PagedCarousel({container:c,autoplay:!1,page_buttons:a}),c.addClass("interactive"),c.addEvent("mousedown",b.bound_events.onThumbnailMouseDown),c.addEvent("mouseup",b.bound_events.onThumbnailMouseUp)},createCarouselPage:function(a,b){var c=this,d=c.carousel_container,e=new Element("div");return 0===b?e.set("data-loaded","loaded").wraps(d.getElement("img")):e.inject(d)},preloadImage:function(a){var b=new Element("img");return b.set("src",a),b.set("alt","").set("role","presentation"),b},onThumbnailHover:function(a){var b=this,c=a.target,d=b.carousel_page_buttons.indexOf(c),e=b.carousel_container.getChildren()[d],f="loaded"===e.get("data-loaded");f||(e.adopt(b.preloadImage(c.get("data-large-image"))),e.set("data-loaded","loaded"))},onThumbnailMouseDown:function(a){var b=this,c=b.carousel_component.getNextIndex(),d=b.carousel_page_buttons[c],e=b.carousel_container.getChildren()[c],f="loaded"===e.get("data-loaded");f||(e.adopt(b.preloadImage(d.get("data-large-image"))),e.set("data-loaded","loaded"))},onThumbnailMouseUp:function(a){var b=this;b.carousel_component.next()}});window.ClipExtrasStills=a}(),function(){"use strict";var a=new Class({initialize:function(){var a=this;a.createElements(),a.createRequests(),a.attachEvents()},createElements:function(){},createRequests:function(){},attachEvents:function(){},open:function(){Singletonbox.open({url:"?action=download_source_file",width:690})}});window.ClipSourceFileDownload=a}(),function(){"use strict";var a=new Class({Implements:[Options],options:{lightbox_url:"#delete",clip_id:null,form:null},initialize:function(a,b){var c=this;if(null===$(a))throw new Error("Invalid element provided to ClipDelete.");c.setOptions(b),c.bindLightbox(a,b)},initializeDelete:function(a){var b=this;b.createElements(a),b.createRequests(),b.attachEvents()},createElements:function(a){var b=this;b.form=$(a.form),b.form.getElement('input[type="password"]')||b.createPassword(),b.form.getElement('input[type="submit"]')||b.createSubmit(),b.input=b.form.getElement('input[type="password"]'),b.error_message=b.form.getElement(".error"),b.submit_button=b.form.getElement('input[type="submit"]'),b.submit_button.set("disabled",!0),setTimeout(function(){b.input.focus()},300)},createRequests:function(){var a=this;a.delete_request=new Form.Request(a.form,a.submit_button,{requestOptions:{url:"/"+a.options.clip_id},extraData:{action:"delete"},onSend:a.onDeleteSend.bind(a),onSuccess:a.onDeleteSuccess.bind(a),onFailure:a.onDeleteFailure.bind(a)}),a.request_validator=new Form.Validator(a.form)},attachEvents:function(){var a=this;a.bound_events.input_keyup=a.onPasswordInputKeyup.bind(a),a.form.getElement('input[type="password"]').addEvent("keyup",a.bound_events.input_keyup)},bindLightbox:function(a,b){var c=this;c.bound_events={lightbox_load:c.initializeDelete.bind(c,b)},c.lightbox=new Lightbox(a,{width:"500px",url:c.options.lightbox_url,onLoad:c.bound_events.lightbox_load})},createPassword:function(){this.form.adopt(new Element("input",{name:"password",type:"password","data-validators":"required",placeholder:Copy.dict.password}))},createSubmit:function(){this.form.adopt(new Element("input",{id:"delete_submit_btn",type:"submit","class":"btn btn_red",value:Copy.dict.deletee}))},onDeleteSend:function(){var a=this;a.input.removeClass("validation-failed"),a.error_message.set("html","")},onDeleteSuccess:function(a,b,c,d){window.location.href=JSON.decode(d)},onDeleteFailure:function(a){var b=this;b.form.reset(),b.input.addClass("validation-failed"),b.error_message.set("html",JSON.decode(a.responseText).password)},onPasswordInputKeyup:function(){var a=this;a.submit_button;""===a.input.get("value")?a.submit_button.set("disabled",!0):a.submit_button.set("disabled",!1)},destroy:function(){var a=this;a.lightbox.removeEvent("load",a.bound_events.lightbox_load),a.form&&a.form.getElement('input[type="password"]').removeEvent("keyup",a.bound_events.input_keyup),a.delete_request&&a.delete_request.disable()}});window.ClipDelete=a}(),function(){"use strict";var a=new Class({STATUS:{UNKNOWN:"unknown",READY:"ready",UPLOAD_IN_PROGRESS:"standby",UPLOAD_ERROR_BLOCKED:"blocked",UPLOAD_ERROR_MOVE:"internal_error",UPLOAD_INVALID_FILE:"invalid_file",UPLOAD_COMPLETE:"upload_complete",UPLOAD_ERROR_QUOTA:"exceeds_quota",UPLOAD_ERROR_INCOMPLETE:"upload_incomplete",TRANSCODE_PENDING:"pending",TRANSCODE_STARTING:"starting",TRANSCODE_ACTIVE:"active",TRANSCODE_FINISHING:"finishing",TRANSCODE_FAILED:"failed",TRANSCODE_DONE:"done"},Implements:[Options],options:{clip_id:null,HD:!1,interval:3e3},request_interval:null,current_status:{},initialize:function(a){var b=this;if(b.setOptions(a),null===b.options.clip_id&&vimeo.config.clip)b.options.clip_id=vimeo.config.clip.id;else if(null===b.options.clip_id)throw new Error("No valid clip ID supplied to ClipStatus.");b.createRequests()},createRequests:function(){var a=this,b=a.getRequestUrl();a.status_request=new Request.JSON({method:"get",url:b,data:{action:"status",hd_status:a.options.HD},onSuccess:a.onRequestSuccess.bind(a),onFailure:a.onRequestFailure.bind(a)})},getRequestUrl:function(){var a="/"+this.options.clip_id;return window.location.href.indexOf("pwnd")>-1&&(a+="/pwnd"),a},getErrorStatuses:function(){var a=this.STATUS;return[a.UNKNOWN,a.UPLOAD_ERROR_MOVE,a.UPLOAD_INVALID_FILE,a.UPLOAD_ERROR_QUOTA,a.UPLOAD_ERROR_INCOMPLETE,a.TRANSCODE_FAILED]},clipInErrorState:function(a){var b,c=this,d=c.getErrorStatuses(),e=d.length;for(b=0;e>b;b++)if(d[b]===a.state)return!0;return!1},onRequestSuccess:function(a){var b=this,c=b.STATUS,d=a.state;b.clipInErrorState(a)?(b.stop(),
Signal.clip.status.failed.dispatch(a)):d===c.READY?(b.stop(),Signal.clip.status.ready.dispatch(a)):d===c.TRANSCODE_DONE?(b.stop(),Signal.clip.status.hd_ready.dispatch(a)):Signal.clip.status.updated.dispatch(a),b.current_status=a},onRequestFailure:function(){var a=this;a.stop(),Signal.clip.status.failed.dispatch({state:a.STATUS.UNKNOWN})},start:function(){var a=this;a.get(),a.request_interval=setInterval(function(){a.get()},a.options.interval)},stop:function(){var a=this;clearInterval(a.request_interval)},get:function(){this.status_request.get()}});window.ClipStatus=a}(),function(){"use strict";var a=new Class({Implements:[Options],options:{HD:!1},initialize:function(){var a=this;a.createElements(),a.attachEvents()},createElements:function(){var a=this;a.clip_status=new ClipStatus({clip_id:vimeo.config.clip.id,HD:a.options.HD})},attachEvents:function(){var a=this;a.bound_events={updated:a.onClipStatusUpdated.bind(a),failed:a.onClipStatusFailure.bind(a),ready:a.onClipStatusReady.bind(a)},Signal.clip.status.updated.add(a.bound_events.updated),Signal.clip.status.failed.add(a.bound_events.failed),Signal.clip.status.ready.add(a.bound_events.ready)},updateStatusView:function(a){var b=this,c=b.clip_status.STATUS;switch(a.state){case c.UPLOAD_IN_PROGRESS:b.uploadInProgress(a);break;case c.UPLOAD_COMPLETE:b.uploadComplete(a);break;case c.UPLOAD_ERROR_BLOCKED:b.uploadBlocked(a);break;case c.TRANSCODE_PENDING:b.transcodePending(a);break;case c.TRANSCODE_STARTING:b.transcodeStarting(a);break;case c.TRANSCODE_ACTIVE:b.transcodeActive(a);break;case c.TRANSCODE_FINISHING:b.transcodeFinishing(a)}},uploadInProgress:function(a){},uploadComplete:function(a){},uploadBlocked:function(a){},transcodePending:function(a){},transcodeStarting:function(a){},transcodeActive:function(a){},transcodeFinishing:function(a){},clipError:function(a){},onClipStatusUpdated:function(a){this.updateStatusView(a)},onClipStatusReady:function(){this.clip_status.stop()},onClipStatusFailure:function(a){var b=this;b.clip_status.stop(),b.clipError(a)},destroy:function(){var a=this;a.clip_status.stop(),Signal.clip.status.updated.remove(a.bound_events.updated),Signal.clip.status.failed.remove(a.bound_events.failed),Signal.clip.status.ready.remove(a.bound_events.ready)}});window.ClipStatusView=a}(),function(){"use strict";var a=new Class({Extends:ClipStatusView,first_update:!0,initialize:function(){var a=this,b=vimeo.config.seed_status;a.parent(),b&&(a.updateStatusView(b),vimeo.config.seed_status=null),a.clip_status.start()},createElements:function(){var a=this;a.parent(),a.video_container=$("video"),a.clip_state_container=$$(".js-clip_state")[0],a.copyright_container=$("copyright_messaging"),a.header=$$(".js-header")[0],a.state_description=$$(".js-description")[0],a.animation_message=$$(".js-animation_message")[0],a.time_left_counter=$$(".js-transcoding_timer")[0],a.time_left_container=$$(".js-time_left")[0],a.retry_upload=$$(".js-retry")[0],a.clip_animation=$$(".js-clip_animation")[0],a.animation_elements=a.clip_animation.getChildren(),a.animation_elements.push(a.clip_animation),a.outer_ring=$$(".outer_ring")[0],a.middle_ring=$$(".middle_ring")[0],a.inner_ring=$$(".inner_ring")[0];try{a.seed_status=JSON.decode($$("[data-seed-status]")[0])}catch(b){}},formatWaitTime:function(a){var b,c=parseInt(a/3600,10)%24,d=parseInt(a/60,10)%60,e=parseInt(a,10)%60;return b=(10>c?"0"+c:c)+":"+(10>d?"0"+d:d)+":"+(10>e?"0"+e:e)},showRetry:function(a){var b=this.clip_status.STATUS;return a===b.INTERNAL_ERROR||a===b.UPLOAD_INCOMPLETE},transcodingUi:function(a){var b=this,c=parseInt(a.percent,10);b.time_left_container.removeClass("hide"),b.time_left_counter.set("html",b.formatWaitTime(a.time_left)),b.setAnimationClasses("transcoding_underway"),b.fillRings(c),b.setCopy(a,parseInt(a.percent,10)+"%")},setCopy:function(a,b){var c=this,d=a.title,e=a.description;c.header.get("html")!==d&&c.header.set("html",d),c.state_description.get("html")!==e&&(c.state_description.set("html",e),Signal.dom.updated.dispatch()),c.animation_message.get("html")!==b&&c.animation_message.set("html",b),c.first_update&&(c.clip_state_container.addClass("visible"),c.first_update=!1)},setAnimationClasses:function(a){var b,c=this;c.animation_elements.each(function(c){b=c.get("data-ring-class")+" "+a,c.set("class",b)})},fillRings:function(a){var b=this;a>=99&&!b.inner_ring.hasClass("fill")&&b.inner_ring.addClass("fill"),a>=66&&!b.middle_ring.hasClass("fill")&&b.middle_ring.addClass("fill"),a>=33&&!b.outer_ring.hasClass("fill")&&b.outer_ring.addClass("fill")},uploadInProgress:function(a){var b=this;b.setAnimationClasses("transcoding_wait"),b.setCopy(a,Copy.dict.uploading)},uploadComplete:function(a){var b=this;b.setAnimationClasses("transcoding_wait"),b.setCopy(a,Copy.dict.upload_complete)},uploadBlocked:function(a){var b=this;b.clip_state_container.addClass("hide"),b.video_container.removeClass("transcoding_progress"),b.copyright_container.removeClass("hide"),b.clip_status.stop()},transcodePending:function(a){var b=this;b.setAnimationClasses("transcoding_wait"),b.setCopy(a,b.formatWaitTime(a.your_wait))},transcodeStarting:function(a){var b=this;b.setAnimationClasses("transcoding_underway"),b.setCopy(a,"")},transcodeActive:function(a){this.transcodingUi(a)},transcodeFinishing:function(a){var b=this;b.transcodingUi(a)},clipError:function(a){var b=this;b.showRetry(a.state)&&b.retry_upload.removeClass("hide"),b.time_left_container.addClass("hide"),b.setAnimationClasses("failure"),b.setCopy(a,"&times;")},onClipStatusFailure:function(a){var b=this;"unknown"===a.state&&(a.title=Copy.dict.failure_default_title,a.description=Copy.dict.failure_default_description),b.parent(a)}});window.ClipTranscodingView=a}(),function(){"use strict";var a=new Class({Extends:ClipStatusView,options:{HD:!0},initialize:function(a){var b=this;b.parent(a),b.transcoding_status&&b.clip_status.start()},createElements:function(){var a=this;a.parent(),a.transcoding_status=$("transcoding_status"),a.transcoding_status_pending=$("transcoding_status_pending"),a.transcoding_status_active=$("transcoding_status_active"),a.transcoding_status_finishing=$("transcoding_status_finishing"),a.transcoding_status_failed=$("transcoding_status_failed"),a.transcoding_status_done=$("transcoding_status_done")},toggleStatus:function(a){var b=this;b.transcoding_status.removeClass("hide").getElements("p").addClass("hide"),a&&(a.removeClass("hide"),b.transcoding_status.show())},transcodePending:function(a){var b=this;b.toggleStatus(b.transcoding_status_pending)},transcodeStarting:function(a){var b=this;b.toggleStatus(b.transcoding_status_pending)},transcodeFinishing:function(a){var b=this;b.toggleStatus(b.transcoding_status_finishing)},transcodeActive:function(a){var b=this,c=b.transcoding_status_active.getElement(".js-percent"),d=b.transcoding_status_active.getElement(".js-time_left");c.set("text",a.percent),d.set("text",a.time_left),b.toggleStatus(b.transcoding_status_active)},clipError:function(a){var b=this;b.toggleStatus(b.transcoding_status_failed)},clipReady:function(){var a=this;a.toggleStatus(a.transcoding_status_done)},onClipStatusReady:function(){var a=this;a.clipReady(),a.clip_status.stop()},onClipStatusFailure:function(a){var b=this;vimeo.cur_user&&vimeo.config.user.id===vimeo.cur_user.id?b.parent(a):(b.toggleStatus(),b.clip_status.stop())}});window.ClipHdTranscodingView=a}(),function(){"use strict";var a=new Class({initialize:function(){var a=this;a.createRequests(),a.attachEvents()},createRequests:function(){var a=this;a.shortcut_request=new Request.JSON({url:vimeo.config.clip.url,onSuccess:a.onShortcutRequestSuccess.bind(a)})},attachEvents:function(){var a=this;a.bound_events={on_previous:a.onPrevious.bind(a),on_next:a.onNext.bind(a),on_brozar_show:a.onBrozarShow.bind(a),on_like:a.onLike.bind(a)},Global.keyManager.register("m",a.bound_events.on_brozar_show),Global.keyManager.register("l",a.bound_events.on_like)},sendShortcutRequest:function(a){this.shortcut_request.send({data:{action:"shortcut",direction:a,token:vimeo.xsrft}})},onPrevious:function(){Signal.brozar.update_stream.dispatch(),this.sendShortcutRequest("prev")},onNext:function(){Signal.brozar.update_stream.dispatch(),this.sendShortcutRequest("next")},onBrozarShow:function(){Signal.brozar.toggle.dispatch()},onShortcutRequestSuccess:function(a){var b=parseInt(a.clip_id,10);b&&b!==vimeo.config.clip.id&&History.push("/"+b)},onLike:function(){new Fx.Scroll(window).toElement("clip")},destroy:function(){var a=this;Global.keyManager.unregister("left",a.bound_events.on_previous),Global.keyManager.unregister("right",a.bound_events.on_next),Global.keyManager.unregister("m",a.bound_events.on_brozar_show),Global.keyManager.unregister("l",a.bound_events.on_like)}});window.ClipShortcuts=a}(),function(){"use strict";var a=new Class({initialize:function(){var a=this;a.createElements(),a.attachEvents()},createElements:function(){var a=this;a.video_meta=$$(".video_meta")[0],a.setMetaTimeAttributes()},attachEvents:function(){var a=this;a.bound_events={time_enter:a.onTimeMouseenter.bind(a),time_leave:a.onTimeMouseleave.bind(a),time_click:a.onTimeClick.bind(a)},a.video_meta.addEvent("mouseenter:relay(time)",a.bound_events.time_enter),a.video_meta.addEvent("mouseleave:relay(time)",a.bound_events.time_leave),$(window).addEvent("click:relay(.video_time)",a.bound_events.time_click)},setMetaTimeAttributes:function(){this.video_meta.getElements("time").each(function(a){a.set("data-timeago",a.get("html")),a.set("data-title",a.get("title")),a.set("tween",{duration:50})})},updateMetaVideoTime:function(a,b,c){var d=this;return a.set("title",b),clearInterval(d.time_interval),d.time_interval=setTimeout(function(){a.fade("out").get("tween").chain(function(){a.set("html",c),a.fade("in")})},1e3),!1},removeEvents:function(){var a=this;a.video_meta.removeEvent("mouseenter:relay(time)",a.bound_events.time_enter),a.video_meta.removeEvent("mouseleave:relay(time)",a.bound_events.time_leave),$(window).removeEvent("click:relay(.video_time)",a.bound_events.time_click)},onTimeClick:function(a,b){var c=parseInt(b.get("data-time"),10);null!==c&&Signal.clip.time_updated.dispatch(c)},onTimeMouseenter:function(a,b){this.updateMetaVideoTime(b,"",b.get("data-title"))},onTimeMouseleave:function(a,b){this.updateMetaVideoTime(b,b.get("data-title"),b.get("data-timeago"))},reset:function(){var a=this;a.removeEvents(),a.createElements(),a.attachEvents()}});window.ClipTime=a}(),function(){"use strict";var a=new Class({ribbon:{target:null,fx:null},initialize:function(){var a=this;a.createElements(),a.attachEvents()},createElements:function(){var a=this;a.container=$("video"),a.container&&a.setupRibbon()},attachEvents:function(){var a=this;a.bound_events={player_ready:a.onPlayerReady.bind(a),player_play:a.onPlayerPlay.bind(a),time_updated:a.onTimeUpdated.bind(a)},Signal.player.ready.add(a.bound_events.player_ready),Signal.player.play.add(a.bound_events.player_play),Signal.clip.time_updated.add(a.bound_events.time_updated)},setupRibbon:function(){var a=this;a.ribbon.target=a.container.getElement(".private"),a.ribbon.fx=new Fx.Elements(a.ribbon.target,{duration:500,transition:"quad:in:out"})},hideRibbon:function(){this.ribbon.fx.start({0:{"margin-left":"-120px","margin-top":"-120px",opacity:0}})},scrollToVideo:function(){var a,b,c=this;a=c.container.getPosition().y+c.container.getSize().y,b=$(window).getScroll().y+$(window).getSize().y,(c.container.getPosition().y<$(window).getScroll().y||a>b)&&Global.smoothScroll(c.container,!0)},onPlayerReady:function(a){this.active_player=a},onPlayerPlay:function(a){var b=this;b.ribbon.target&&b.hideRibbon(),a===b.active_player&&b.scrollToVideo()},onTimeUpdated:function(a){var b=this;b.active_player&&(b.active_player.currentTime=a,b.scrollToVideo())},destroy:function(){var a=this;Signal.player.ready.remove(a.bound_events.player_ready),Signal.player.play.remove(a.bound_events.player_play)}});window.ClipPlayer=a}(),function(){"use strict";var a=new Class({Implements:[Options],options:{type:null,id:null,request_url:window.location.href,current_member:!1},initialize:function(a,b){var c=this;if(null===$(a))throw new Error("Invalid element provided to CollectionManager");if(null===b.type||null===b.id)throw new Error("Invalid type or ID provided to CollectionManager");c.setOptions(b),c.createElements(a),c.createRequests(),c.attachEvents()},createElements:function(a){var b=this;b.input=a,b.container=a.getParent("li"),b.current_member=b.options.current_member},createRequests:function(){var a=this;a.change_membership_request=new Request.JSON({url:a.options.request_url,method:"post",onSuccess:a.onChangeMembershipRequestSuccess.bind(a),onRequest:a.onChangeMembershipRequested.bind(a)})},attachEvents:function(){var a=this;a.input.addEvent("click",a.toggleCollectionMembership.bind(a)),a.container.addEvent("click:relay(.pending)",a.toggleCollectionMembership.bind(a))},sendMembershipRequest:function(a){var b=this;b.change_membership_request.send({data:{action:"toggle_collection",type:b.options.type,id:b.options.id,toggle:a,token:vimeo.xsrft}})},createThrobber:function(){var a=this;a.throbber=new Throbber({size:12,padding:2,color:"#000"}),a.container.grab(a.throbber.elem),a.throbber.elem.addClass("throbber js-notification"),a.throbber.start()},createPendingIcon:function(){var a=this;a.pending&&a.pending.destroy(),a.pending=new Element("div",{"class":"pending_icon viconify_face_b js-notification green",title:"This collection requires admin approval."}),a.container.grab(a.pending)},toggleCollectionMembership:function(a){var b=this;b.current_member?b.remove():b.add()},onChangeMembershipRequestSuccess:function(a,b){var c=this,d=JSON.decode(b);$(a.target);switch(d.status){case"pending":c.createPendingIcon(),c.current_member=!0;break;case"added":c.current_member=!0;break;case"removed":c.current_member=!1}c.container.getElement(".throbber").destroy(),c.input.removeClass("requested"),Signal.collection_membership.changed.dispatch(d)},onChangeMembershipRequested:function(a){var b=this;b.container.getElements(".js-notification").destroy(),b.input.set("class","requested"),b.createThrobber()},onChangeMembershipRequestFailure:function(a,b){Singletonbox.alert("VimeoUhOh","Sorry! We were unable to add this clip.")},add:function(){this.sendMembershipRequest("add")},remove:function(){this.sendMembershipRequest("remove")}});window.CollectionManager=a}(),function(){"use strict";var a=new Class({possible_contexts:["group","channel","album","portfolio"],initialize:function(a,b){var c=this;if(null===$(a))throw new Error("Please provide a valid element.");if(-1===c.possible_contexts.indexOf(b))throw new Error("Please provide a collection context");c.context=b,c.createElements(a),c.attachEvents()},createElements:function(a){var b=this;b.trigger=a},attachEvents:function(){var a=this;a.bound_events={trigger_click:a.onTriggerClick.bind(a),key_down:a.onKeyDown.bind(a),cancel_click:a.onCancelClick.bind(a),add_collection_click:a.onAddCollectionClick.bind(a)},a.trigger.addEvent("click",a.bound_events.trigger_click)},createInput:function(){var a=this;a.input_wrapper=new Element("div",{"class":"collection_creator_wrapper"}),a.input=new Element("input",{type:"text",maxLength:"128",placeholder:a.context.capitalize()+" Name"}),a.add_collection=new Element("button",{type:"button","class":"btn add_collection","data-submit-text":Copy.dict.adding+"…",html:Copy.dict.add}),a.cancel=new Element("a",{"class":"cancel_collection",html:Copy.dict.cancel}),a.input_wrapper.grab(a.input).grab(a.add_collection).grab(new Element("span",{html:Copy.dict.or+" ","class":"cancel_wrapper txt_sm"}).grab(a.cancel)),a.input.addEvent("keydown",a.bound_events.key_down),a.add_collection.addEvent("click",a.bound_events.add_collection_click),a.cancel.addEvent("click",a.bound_events.cancel_click)},applyCollectionAddingState:function(){var a=this;Signal.collection_membership.collection_added.dispatch({context:a.context,name:a.input.get("value")}),a.add_collection.set("html",a.add_collection.get("data-submit-text")),a.input_wrapper.addClass("adding")},onTriggerClick:function(a){var b=this;a.preventDefault(),b.trigger_clone=b.trigger.clone(),b.createInput(),b.input_wrapper.replaces(b.trigger),b.input.focus()},onKeyDown:function(a){var b=this;"enter"===a.key&&(a.preventDefault(),b.applyCollectionAddingState())},onCancelClick:function(){this.refresh()},onAddCollectionClick:function(){this.applyCollectionAddingState()},refresh:function(){var a=this;a.trigger_clone.replaces(a.input_wrapper),a.destroy(),a.createElements(a.trigger_clone),a.attachEvents()},destroy:function(){var a=this;a.trigger.removeEvent("click",a.bound_events.trigger_click),a.input.removeEvent("keydown",a.bound_events.key_down),a.add_collection.removeEvent("click",a.bound_events.add_collection_click),a.cancel.removeEvent("click",a.bound_events.cancel_click)}});window.CollectionCreator=a}();var UserFollowButton=new Class({Implements:[Options],is_following:!1,options:{element:null,user_id:null},initialize:function(a){var b=this;b.setOptions(a),b.createElements(),b.createRequests(),b.attachEvents()},createElements:function(){var a=this;a.button_element=$(a.options.element)},createRequests:function(){var a=this;a.follow_request=new Request({url:"/user"+a.options.user_id,method:"post",onRequest:a.onRequestStart.bind(a),onSuccess:a.onRequestSuccess.bind(a)})},attachEvents:function(){var a=this;a.button_element.addEvent("mouseover",a.onMouseOver.bind(a)),a.button_element.addEvent("mouseout",a.onMouseOut.bind(a)),a.button_element.addEvent("click",a.onToggleFollow.bind(a)),Signal.user.followed.add(a.onFollowed.bind(a)),Signal.user.unfollowed.add(a.onUnfollowed.bind(a))},isFollowing:function(){var a=this;return 1===a.button_element.get("data-subscribed").toInt()},setFollowing:function(a){var b=this,c=b.button_element;b.swapLabels(),a?c.removeClass("follow").addClass("following"):c.removeClass("following").addClass("follow")},swapLabels:function(){var a=this,b=a.button_element,c=b.get("data-hover-text"),d=b.get("data-btn-text"),e=b.get("data-alternate-text");b.set("data-btn-text",e).set("text",e).set("data-hover-text",b.get("data-alternate-hover")).set("data-alternate-text",d).set("data-alternate-hover",c)},onMouseOver:function(){var a=this,b=a.button_element;b.set("text",b.get("data-hover-text"))},onMouseOut:function(){var a=this,b=a.button_element;b.set("text",b.get("data-btn-text"))},onToggleFollow:function(a){var b=this;b.follow_request.isRunning()||(b.follow_request.send({data:{action:"toggle_follow",token:vimeo.xsrft}}),a.preventDefault())},onRequestStart:function(){var a=this;a.button_element.hasClass("following")&&a.button_element.removeClass("following").addClass("unfollowing"),a.button_element.addClass("btn_disabled")},onRequestSuccess:function(a){var b=this,c="true"===a;b.button_element.removeClass("btn_disabled").removeClass("unfollowing"),c?Signal.user.followed.dispatch(b.options.user_id):Signal.user.unfollowed.dispatch(b.options.user_id)},onFollowed:function(a){var b=this;a===b.options.user_id&&b.setFollowing(!0)},onUnfollowed:function(a){var b=this;a===b.options.user_id&&b.setFollowing(!1)}}),UserSuggestionsPanel=new Class({Implements:[Options],has_loaded:!1,options:{element:null,user_id:null,panel_height:null},initialize:function(a){var b=this;b.setOptions(a),b.createElements(),b.createRequests(),b.attachEvents()},createElements:function(){var a=this;a.panel_element=$(a.options.element)},createRequests:function(){var a=this;a.suggestions_request=new Request.HTML({method:"get",update:a.panel_element,onSuccess:a.onRequestSuccess.bind(a)})},attachEvents:function(){var a=this;a.panel_element.addEvent("click:relay(.undertaker)",a.onClose.bind(a)),Signal.user.followed.add(a.onFollowed.bind(a))},onFollowed:function(a){var b=this,c=b.options.user_id;(null===c||a===c&&!b.has_loaded)&&b.load(a)},onRequestSuccess:function(){var a=this,b=a.panel_element,c=a.options.panel_height;null!==a.options.user_id&&(a.has_loaded=!0),c?b.addClass("open").setStyle("height",c):b.addClass("open").setStyle("height",b.measure(function(){return this.getSize().y})),Signal.user.suggestions_returned.dispatch({panel_height:c})},onClose:function(a){var b=this;b.panel_element;b.panel_element.removeClass("open").setStyle("height",null).empty(),a.preventDefault()},load:function(a){var b=this;b.suggestions_request.isRunning()||(!a&&b.options.user_id&&(a=b.options.user_id),b.suggestions_request.send({url:"/user"+a,data:{action:"suggest_followers"}}))}});!function(){"use strict";var a=new Class({Implements:[Options],DOWNLOAD_REFRESH:27e4,options:{container:null,toggle:null,request_action:null},content_requested:!1,is_open:!1,initialize:function(a){var b=this;b.setOptions(a),b.createElements(),b.createRequests(),b.attachEvents()},createElements:function(){var a=this,b=a.options;if(a.container=$(b.container),a.toggle=$(b.toggle),null===a.container)throw new Error("Invalid container supplied to ClipActionPanel");if(null===a.toggle)throw new Error("Invalid toggle supplied to ClipActionPanel")},createRequests:function(a){var b=this,c={method:"get",url:b.createRequestUrl(b.options.request_action),update:b.container,onSuccess:b.onContentRequestSuccess.bind(b),onFailure:b.onContentRequestFailure.bind(b)};a&&(c=Object.merge(c,a)),b.content_request=new Request.HTML(c)},attachEvents:function(){var a=this;a.bound_events={toggle_click:a.onToggleClick.bind(a),close_button_click:a.onCloseButtonClick.bind(a)},a.toggle.addEvent("click",a.bound_events.toggle_click),a.container.addEvent("click:relay(.undertaker)",a.bound_events.close_button_click)},createRequestUrl:function(){return"?action="+this.options.request_action},createErrorMessage:function(){return new Element("div",{"class":"alert tool_alert"}).adopt(new Element("em",{html:"!"})).adopt(new Element("p",{html:"Sorry, this feature is unavailable at the moment."}))},renderErrorMessage:function(){var a,b=this,c=b.container;a||(a=b.createErrorMessage()),c.empty(),c.adopt(a)},onToggleClick:function(a,b){var c=this;c.container.hasClass("closed")?c.open():c.close(),a.preventDefault()},onCloseButtonClick:function(a){var b=this;b.close(),a.preventDefault()},onContentRequestSuccess:function(){var a=this;a.content_requested||(a.content_requested=!0,a.open())},onContentRequestFailure:function(){var a=this;a.error_message,a.options.container;a.renderErrorMessage(),a.content_requested=!0,a.open()},removeEvents:function(){var a=this;a.toggle.removeEvent("click",a.bound_events.toggle_click),a.container.removeEvent("click:relay(.undertaker)",a.bound_events.close_button_click)},close:function(){var a=this;a.toggle.removeClass("active"),a.container.addClass("closed"),a.is_open=!1,Signal.clip.action_panel.closed.dispatch({action_panel_instance:a})},open:function(a){var b=this;return b.content_requested?(b.toggle.hasClass("active")||(b.toggle.addClass("active"),b.container.removeClass("closed")),b.is_open=!0,void(b.content_requested&&Signal.clip.action_panel.opened.dispatch({action_panel_instance:b,panel_height:a}))):void b.load()},load:function(){var a=this;a.content_request.send(),"download"===a.options.request_action&&setTimeout(a.load.bind(a),a.DOWNLOAD_REFRESH)},reset:function(){var a=this;a.close(),a.container.empty(),a.content_requested=!1},destroy:function(){var a=this;a.reset(),a.removeEvents()},isOpen:function(){var a=this,b=!!a.is_open;return b}});window.ClipActionPanel=a}(),function(){"use strict";var a=new Class({Extends:ClipActionPanel,createRequests:function(){var a=this;a.parent(),a.update_collection_list_request=new Request.HTML({url:vimeo.config.clip.url,method:"post",onSuccess:a.onUpdateCollectionListSuccess.bind(a),onFailure:a.onUpdateCollectionListFailure.bind(a)})},attachEvents:function(){var a=this;a.parent(),Signal.collection_membership.changed.add(a.onCollectionMembershipChange.bind(a)),Signal.collection_membership.collection_added.add(a.onNewCollectionAdded.bind(a))},initializeCollectionManagers:function(a){a.getElements('input[type="checkbox"]').each(function(a){new CollectionManager(a,{type:a.get("data-type"),id:a.get("value"),request_url:vimeo.config.clip.url+"?action=adder",current_member:a.get("checked")})})},initializeCreators:function(){var a,b=this;b.collection_creators={},["group","channel","album","portfolio"].each(function(c){a=$$(".js-create_"+c)[0],a&&(b.collection_creators[c]=new CollectionCreator(a,c))})},disableGroupInputs:function(){this.container.getElements('input[data-type="group"]:not(:checked)').each(function(a){a.getNext("label").addClass("disabled"),a.disabled=!0}),this.container.getElements("#create_group_link").addClass("hidden"),this.container.getElements("#max_group_warning").removeClass("hidden")},enableGroupInputs:function(){this.container.getElements('input[data-type="group"]:disabled').each(function(a){a.getNext("label").removeClass("disabled"),a.disabled=!1}),this.container.getElements("#create_group_link").removeClass("hidden"),this.container.getElements("#max_group_warning").addClass("hidden")},getCollection:function(a){return $$(".js-"+a+"_collection")[0]},checkUserCapabilities:function(a){var b=this,c=b.getCollection(a);"0"===c.getElement(".addto").get("data-create-more")&&(c.getElement(".js-promo").removeClass("hide"),$$(".js-create_"+a)[0].destroy(),b.collection_creators[a].destroy())},refreshList:function(){var a=this;a.collection_creators[a.updated_context].refresh(),a.initializeCollectionManagers(a.getCollection(a.updated_context)),a.checkUserCapabilities(a.updated_context),a.updated_context=null},onContentRequestSuccess:function(){var a=this;a.parent(),a.initializeCollectionManagers(a.container),a.initializeCreators()},onCollectionMembershipChange:function(a){var b=this;a.membership_limit_reached?b.disableGroupInputs():b.enableGroupInputs()},onNewCollectionAdded:function(a){var b=this,c=a.name,d=a.context,e=b.getCollection(d).getElement(".js-addto_container");b.updated_context=d,b.update_collection_list_request.setOptions({update:e}),b.update_collection_list_request.send({data:{action:"create_"+d,name:c,token:vimeo.xsrft}})},onUpdateCollectionListSuccess:function(){var a=this;a.refreshList(),Signal.clip.action_panel.height_changed.dispatch({action_panel_instance:a})},onUpdateCollectionListFailure:function(){this.refreshList()}});window.ClipAdderPanel=a}(),function(){"use strict";var a=new Class({Extends:ClipActionPanel,attachEvents:function(){var a=this;a.parent(),a.container.addEvent("click:relay(.js-cold_file)",a.onColdFileDownload.bind(a))},onColdFileDownload:function(a){var b=this;a.preventDefault(),b.source_file_download=new ClipSourceFileDownload,b.source_file_download.open()}});window.ClipDownloadPanel=a}(),function(){"use strict";var a=new Class({Extends:ClipActionPanel,Implements:[Options],custom_request_options:{track_event:["_trackEvent","ajax","stats","clip"]},initialize:function(a){var b=this;b.parent(a),b.showStatsOnLoad()&&b.open()},createRequests:function(){var a=this;a.parent(a.custom_request_options)},userIsClipOwner:function(){return null!==vimeo.cur_user&&vimeo.cur_user.id===vimeo.config.user.id},showStatsOnLoad:function(){var a=Cookie.read("auto_load_stats");return this.userIsClipOwner()&&"1"===a},writeAutoloadCookie:function(a){Cookie.write("auto_load_stats",a,{domain:vimeo.domain,path:"/",duration:365})},open:function(){var a=this;a.parent(),a.writeAutoloadCookie("1")},close:function(){var a=this;a.parent(),a.writeAutoloadCookie("0")}});window.ClipStatsPanel=a}(),function(){"use strict";var a=new Class({Extends:ClipActionPanel,createRequests:function(){var a=this;a.user_follow_button=new UserFollowButton({element:a.toggle,user_id:vimeo.config.user.id}),a.user_suggestions_panel=new UserSuggestionsPanel({element:a.container,user_id:vimeo.config.user.id,panel_height:200})},attachEvents:function(){var a=this;a.parent(),Signal.user.suggestions_returned.add(a.onSuggestionsReturned.bind(a)),Signal.user.followed.add(a.onUserFollowed.bind(a))},onSuggestionsReturned:function(a){var b=this;b.content_requested=!0,b.open(a.panel_height)},onToggleClick:function(){var a=this;a.isOpen()&&a.close()},onUserFollowed:function(){this.open()},load:function(){this.user_suggestions_panel.load()}});window.ClipFollowPanel=a}(),function(){"use strict";var a=new Class({Extends:ClipActionPanel,custom_request_options:{data:{tipped:!0}},initialize:function(a){var b=this;b.parent(a),b.showTipOnLoad()&&b.open()},createRequests:function(){var a=this;a.showTipOnLoad()?a.parent(a.custom_request_options):a.parent()},showTipOnLoad:function(){return window.location.hash.indexOf("tipped")>-1}});window.ClipTipjarPanel=a}(),function(){"use strict";var a=new Class({initialize:function(a){var b=this;b.createElements(a),b.createRequests(),b.attachEvents()},createElements:function(a){var b=this;b.accept_clip=a.filter(".accept"),b.reject_clip=a.filter(".reject")},createRequests:function(){var a=this;a.pending_clip_request=new Request.JSON({url:window.location.href,method:"post",onSuccess:a.onPendingClipRequestSuccess.bind(a)})},attachEvents:function(){var a=this;a.bound_events={accept_clip:a.onAcceptClipClick.bind(a),reject_clip:a.onRejectClipClick.bind(a)},a.accept_clip.addEvent("click",a.bound_events.accept_clip),a.reject_clip.addEvent("click",a.bound_events.reject_clip)},sendPendingClipRequest:function(a){this.pending_clip_request.send({data:{token:vimeo.xsrft,action:a}})},createSuccessElement:function(a,b){return new Element("span",{"class":"message pending_video_message "+b,html:a}).set("tween",{onComplete:function(a){a.destroy()}})},fadeMessage:function(a){setTimeout(function(){a.get("tween").start("opacity",0)},3e3)},renderConfirmation:function(a){var b,c=this,d=$("flag_link");b="accept"===a?c.createSuccessElement("accepted!","green"):c.createSuccessElement("rejected!","red"),b.inject(d,"before"),c.destroy(),c.fadeMessage(b)},onAcceptClipClick:function(){this.sendPendingClipRequest("approve_item")},onRejectClipClick:function(){this.sendPendingClipRequest("delete_item")},onPendingClipRequestSuccess:function(a){this.renderConfirmation(a.mode)},destroy:function(){var a=this;a.accept_clip&&(a.accept_clip.removeEvent("click",a.bound_events.accept_clip),a.accept_clip.destroy()),a.reject_clip&&(a.reject_clip.removeEvent("click",a.bound_events.reject_clip),a.reject_clip.destroy())}});window.ClipPendingApproval=a}(),function(){"use strict";var a=new Class({MEDIA_QUERY_BREAK_POINT:1120,HIDE_BROZAR:"hide_brozar",STREAM_ID:"stream_id",STREAM_POS:"stream_pos",brozar_initialized:!1,brozar_open:!1,touch_device:"ontouchstart"in window,initialize:function(){var a=this;a.createElements(),a.container&&(a.injectBrozarToggle(),a.attachEvents(),$(window).scroll(0,1),Cookie.read(a.HIDE_BROZAR)||a.loadFromOpenState())},createElements:function(){var a=this;a.container=$("brozar"),a.brozar_toggle_wrapper=$("brozar_toggle_wrapper"),a.clip_shortcuts=new ClipShortcuts},attachEvents:function(){var a=this,b=12,c="brozar_sticky",d="closed";a.bound_events={toggle_click:a.onBrozarToggleClick.bind(a),viewport_change:a.onViewportChange.bind(a),update_stream:a.onUpdateStream.bind(a)},Signal.brozar.update_stream.add(a.bound_events.update_stream),Cookie.read(a.HIDE_BROZAR)||(d="open",_gaq.push(["_setCustomVar",b,c,d,window.CV_SCOPE_PAGE])),a.brozar_toggle.addEvent("click",a.bound_events.toggle_click),Browser.ie&&Browser.version<10?$(window).addEvent("resize",a.bound_events.viewport_change):a.brozar_toggle.addEvent(Element.Events.transitionend.base,a.bound_events.viewport_change)},getContainerHeight:function(){return this.container.getSize().y},abbreviateText:function(){return $(window).getSize().x<this.MEDIA_QUERY_BREAK_POINT},initializeBrozar:function(a){var b=this;b.brozar_initialized||(b.installBrozar(a),b.createBrozar()),b.brozar_initialized=!0},createBrozarToggle:function(){return new Element("a",{href:"javascript:void(0)",id:"toggle","class":"open",html:Copy.dict.more_videos,title:Copy.dict.see_more_videos})},createBrozar:function(){var a=this;a.brozar=new Brozar(a.container,{url:vimeo.config.clip.url,stream_id:Cookie.read(a.STREAM_ID),
stream_position:Cookie.read(a.STREAM_POS),thumbnail_width:180,width_buffer:45,promo_videos:1,container_width:document.body.getSize().x,recommendation_algorithm:"v0",onClipSelected:a.onClipSelected.bind(a)}),Cookie.dispose(a.STREAM_ID,{domain:vimeo.domain,path:"/"}),Cookie.dispose(a.STREAM_POS,{domain:vimeo.domain,path:"/"})},createBrozarScroll:function(){var a=this;a.brozar_scroll=new Fx.Scroll(window,{duration:200,transition:Fx.Transitions.Expo.easeOut,onStart:function(){a.brozar_open&&a.container.setStyle("height",null)},onComplete:function(){a.brozar_open||(a.container.setStyle("height",0),a.brozar_scroll.set(0,0))}})},updateStreamClips:function(){var a=$("stream_clips");a&&a.set({html:vimeo.config.user.name+"&rsquo;s videos",title:vimeo.config.user.name+"&rsquo;s videos","data-stream":"clips:"+vimeo.config.user.id})},updateStreamRelated:function(){var a=$("stream_related");a&&a.set({html:"Related videos",title:"related videos","data-stream":"related:"+vimeo.config.clip.id})},injectBrozarToggle:function(){var a=this;a.brozar_toggle=a.createBrozarToggle(),a.brozar_toggle.inject(a.brozar_toggle_wrapper,"top"),setTimeout(function(){a.brozar_toggle.addClass("active")},250)},injectBrozar:function(a){var b=this;b.container.inject($("ribbon"),"before").show(),a||b.brozar_scroll.set(0,b.getContainerHeight()+1),b.scroll_pending&&(b.openWithScroll(),b.scroll_pending=!1)},installBrozar:function(a){var b=this;b.createBrozarScroll(),a?b.setBrozarOpenAttributes():b.setBrozarCloseAttributes(),b.injectBrozar(a)},toggleCopy:function(a,b){var c,d=this,e=d.brozar_toggle;c=d.abbreviateText()?a:b,e.set("html",c),e.set("title",b)},setBrozarOpenAttributes:function(){var a=this;a.toggleCopy(Copy.dict.hide_videos_abbr,Copy.dict.hide_videos),a.brozar_toggle.removeClass("open").addClass("close"),a.brozar_open=!0},setBrozarCloseAttributes:function(){var a=this;a.toggleCopy(Copy.dict.more_videos_abbr,Copy.dict.more_videos),a.brozar_toggle.addClass("open").removeClass("close"),a.brozar_open=!1},logBrozarToggleClick:function(a){var b=this;new Request({url:window.location.pathname,method:"post",data:{action:"log_onsite_click",type:"brozar-"+a,stream:b.brozar.stream_id,recommendation_algorithm:b.brozar.recommendation_algorithm,token:vimeo.xsrft}}).send()},onClipSelected:function(a){History.push(a)},onBrozarToggleClick:function(a){var b=this;b.load(),b.brozar_open?(b.closeWithScroll(a),b.logBrozarToggleClick("hide")):(b.openWithScroll(),b.logBrozarToggleClick("show"))},onViewportChange:function(a){var b=this;b.brozar_open?b.setBrozarOpenAttributes():b.setBrozarCloseAttributes()},onUpdateStream:function(){var a=this;a.brozar_initialized&&Cookie.write(a.STREAM_ID,$("streams").get("data-stream"),{domain:vimeo.domain,path:"/"})},open:function(a){var b=this;b.setBrozarOpenAttributes(),a&&b.brozar_scroll.start(0,0),Cookie.write(b.HIDE_BROZAR,0,{duration:-1,path:"/",domain:vimeo.domain})},openWithScroll:function(){this.open(!0)},close:function(a,b){var c=this;c.setBrozarCloseAttributes(),c.touch_device&&c.brozar_open||!a||c.brozar_scroll.start(0,c.getContainerHeight()),b&&b.type&&Cookie.write(c.HIDE_BROZAR,1,{path:"/",domain:vimeo.domain})},closeWithScroll:function(a){this.close(!0,a)},show:function(a){var b=this;b.brozar_initialized?b.open(a):(b.load(),b.scroll_pending=!0)},showWithScroll:function(){this.show(!0)},toggle:function(){this.onBrozarToggleClick()},load:function(a){var b=this;b.brozar_initialized||b.initializeBrozar(a)},loadFromOpenState:function(){this.load(!0)},update:function(){var a=this;null!==a.container&&a.brozar_initialized&&(a.updateStreamClips(),a.updateStreamRelated(),a.brozar.setActiveClip())}});window.ClipBrozarController=a}(),function(){"use strict";var a=new Class({PANEL_PADDING:19,action_panels:[],active_action_panel:null,initialize:function(){var a=this;a.createElements(),a.createRequests(),a.attachEvents()},createElements:function(){var a=this,b=$$(".js-clip_description")[0],c=$$(".js-clip_delete")[0],d=$("delete_form"),e=$$(".js-clip_action_panel_btn"),f=$$(".js-pending_clip_control");a.source_file_recommendation_panel=$$(".js-sfr_panel")[0],a.tool_wrapper=$$(".tool_wrapper")[0],a.clip_title=$$(".js-clip_title")[0].innerHTML+" on Vimeo",a.read_more=new ReadMore(b),a.storeActionPanels(e),f&&(a.clip_pending_approval=new ClipPendingApproval(f)),c&&(a.clip_delete=new ClipDelete(c,{form:d,clip_id:vimeo.config.clip.id})),vimeo.config.file_available&&(a.transcoding_view=new ClipHdTranscodingView)},createRequests:function(){var a=this;a.clip_info_request=new Request.HTML({update:"info",method:"get",data:{action:"info"},onSuccess:a.onClipInfoRequestSuccess.bind(a)})},attachEvents:function(){var a=this;Signal.clip.action_panel.opened.add(a.onActionPanelOpened.bind(a)),Signal.clip.action_panel.closed.add(a.onActionPanelClosed.bind(a)),Signal.clip.action_panel.height_changed.add(a.onActionPanelHeightChanged.bind(a)),Signal.clip.changed.add(a.onClipChanged.bind(a)),Signal.clip.status.ready.add(a.onClipChanged.bind(a,vimeo.config.clip.id)),Signal.clip.status.updated.add(a.onClipStatusUpdated.bind(a)),a.source_file_recommendation_panel&&$$(".js-sfr_close").addEvent("click",a.onSourceFileRecommendationClose.bind(a))},storeActionPanels:function(a){var b=this;a.each(function(a){b.action_panels.push(b.createActionPanelFromToggle(a))})},createActionPanelFromToggle:function(a){var b=this,c=$$(a.get("data-panel-selector"))[0],d=a.get("data-request-action");return b.createClipActionPanel(a,c,d)},createClipActionPanel:function(a,b,c){var d,e={container:b,toggle:a,request_action:c};switch(c){case"follow":d=new ClipFollowPanel(e);break;case"adder":d=new ClipAdderPanel(e);break;case"stats":d=new ClipStatsPanel(e);break;case"download":d=new ClipDownloadPanel(e);break;case"tipjar":d=new ClipTipjarPanel(e);break;default:d=new ClipActionPanel(e)}return d},sendInfoRequest:function(a){var b=this,c=vimeo.config.context,d=null,e=null;c&&(d=c.split(":")[0],e=c.split(":")[1]),b.clip_info_request.send({url:"/"+a,data:{action:"info",context_type:d,context_id:e}})},reset:function(){var a,b=this,c=b.action_panels.length;for(b.transcoding_view&&b.transcoding_view.destroy(),b.clip_delete&&b.clip_delete.destroy(),b.clip_pending_approval&&b.clip_pending_approval.destroy(),a=0;c>a;a++)b.action_panels[a].destroy();b.action_panels=[]},onActionPanelOpened:function(a){var b=this,c=b.active_action_panel,d=a.action_panel_instance,e=a.panel_height;null!==c&&b.active_action_panel!==d&&c.close(),b.active_action_panel=d,e?b.tool_wrapper.setStyle("display","block"):b.tool_wrapper.setStyle("display","block")},onActionPanelClosed:function(a){var b=this;a.action_panel_instance.toggle.blur(),b.active_action_panel=null,b.tool_wrapper.setStyle("display","none")},onActionPanelHeightChanged:function(a){var b=this;b.tool_wrapper.setStyle("height",a.action_panel_instance.container.scrollHeight+b.PANEL_PADDING)},onClipInfoRequestSuccess:function(a,b,c){var d=this;d.createElements(),document.title=d.clip_title,Signal.clip.info_updated.dispatch()},onClipChanged:function(a){var b=this;b.reset(),b.sendInfoRequest(a)},onClipStatusUpdated:function(a){var b=this;a.is_uploading||b.info_updated||(b.reset(),b.sendInfoRequest(vimeo.config.clip.id),b.info_updated=!0)},onSourceFileRecommendationClose:function(a){var b=this;b.source_file_recommendation_panel.destroy(),new Request({url:"/"+vimeo.config.clip.id,method:"post",data:{token:vimeo.xsrft,action:"dismiss_source_file_recommendation",dismissed_state:1}}).send(),a.preventDefault()}});window.ClipInfoController=a}(),function(){"use strict";var a=new Class({initialize:function(){var a=this;a.createElements(),a.createRequests(),a.attachEvents()},createElements:function(){var a=this;a.video=$("video"),a.container=$("clip"),a.brozar=new ClipBrozarController,a.clip_time=new ClipTime,a.fileUnavailable()?a.transcoding_view=new ClipTranscodingView:a.clip_player=new ClipPlayer},attachEvents:function(){var a=this;a.bound_events={clip_changed:a.onClipChange.bind(a),clip_status_ready:a.onClipReady.bind(a),clip_info_updated:a.onClipInfoUpdated.bind(a),player_play:a.onPlayerPlay.bind(a),brozar_show:a.onBrozarToggle.bind(a)},Signal.clip.changed.add(a.bound_events.clip_changed),Signal.clip.status.ready.add(a.bound_events.clip_status_ready),Signal.clip.info_updated.add(a.bound_events.clip_info_updated),Signal.player.play.add(a.bound_events.player_play),Signal.brozar.toggle.add(a.bound_events.brozar_show)},createRequests:function(){var a=this;a.player_request=new Request.HTML({method:"get",update:"video",onSuccess:a.onPlayerRequestSuccess.bind(a)})},fileUnavailable:function(){return $$("[data-file-unavailable]").length>0},sendPlayerRequest:function(a){var b=this,c=vimeo.config.context,d=null,e=null;c&&(d=c.split(":")[0],e=c.split(":")[1]),b.player_request.send({data:{clip_id:a,server:vimeo.url,context_type:d,context_id:e,action:"player"}})},updateClipConfig:function(a){vimeo.config.clip.id=a,vimeo.config.clip.url="/"+a},createCover:function(){var a=this;a.removeCover(),a.clip_cover=new Element("div",{"class":"clip_cover"}),a.clip_cover.inject(a.container,"bottom")},removeCover:function(){var a=this;a.clip_cover&&a.clip_cover.dispose()},reset:function(){var a=this;a.transcoding_view&&(a.transcoding_view.destroy(),a.video.removeClass("transcoding_progress")),a.clip_player&&a.clip_player.destroy(),a.play_log_recorded=!1},whLogSearchPromoPlay:function(a){Cookie.dispose("search_ref"),new Request({url:window.location.pathname,method:"post",data:{action:"log_onsite_play",clip_id:a,token:vimeo.xsrft,type:"search_promo"}}).send()},whLogBrozarPlay:function(a,b){var c=b||"brozar",d={action:"log_onsite_play",clip_id:a,token:vimeo.xsrft,type:c};Cookie.dispose("play_log_ref"),this.play_log_recorded=!0,new Request({url:window.location.pathname,method:"post",data:d}).send()},onPlayerRequestSuccess:function(){var a=this;a.removeCover(),a.brozar.update(),a.fileUnavailable()?(a.video.addClass("transcoding_progress"),a.transcoding_view=new ClipTranscodingView):a.clip_player=new ClipPlayer,Global.setupContentFilterSelector()},onClipChange:function(a){var b=this;b.reset(),b.createCover(),b.updateClipConfig(a),b.sendPlayerRequest(a)},onClipReady:function(){var a=this;a.reset(),a.sendPlayerRequest(vimeo.config.clip.id)},onClipInfoUpdated:function(){this.clip_time.reset()},onPlayerPlay:function(a){function b(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}var c=this,d=Cookie.read("search_ref");if(b("from"))return new Request({url:window.location.pathname,method:"post",data:{action:"log_onsite_play",clip_id:vimeo.config.clip.id,token:vimeo.xsrft,type:b("from")}}).send(),void("replaceState"in history&&history.replaceState(null,null,location.toString().replace(location.search,"").replace("?","")));d&&c.whLogSearchPromoPlay(d);var e,f,g,h,i,j=window.location.pathname.split("/"),k=Cookie.read("play_log_ref"),l=null!==k;l?(e=k.split(":"),f=e[0],g=parseInt(e[1],10),h=parseInt(j[j.length-1],10),i=g===h):i=!1,i&&!c.play_log_recorded&&c.whLogBrozarPlay(h,f)},onBrozarToggle:function(){this.brozar.toggle()}});window.ClipPlayerController=a}(),function(){"use strict";var a=new Class({main_module:null,scrollspy_module:null,likes_module:null,credits_module:null,stills_module:null,initialize:function(){var a=this;a.createElements(),a.attachEvents()},createElements:function(){var a=this;a.main_module=new ClipExtrasMain,a.scrollspy_module=new ClipExtrasScrollSpy},attachEvents:function(){var a=this;Signal.clip.extras.loaded.add(a.onExtrasLoaded.bind(a))},onExtrasLoaded:function(){var a=this;a.reset()},reset:function(){var a=this;a.credits_module&&a.credits_module.destroy(),a.stills_module&&a.stills_module.destroy(),a.credits_module=new ClipExtrasCredits,a.stills_module=new ClipExtrasStills,a.likes_module=new ClipExtrasLikes}});window.ClipExtrasController=a}(),function(){"use strict";var a=new Class({initialize:function(){var a=this;a.createElements(),a.attachEvents(),a.checkUrl()},createElements:function(){var a=this;a.clip_info_controller=new ClipInfoController,a.clip_player_controller=new ClipPlayerController,a.clip_extras_controller=new ClipExtrasController},attachEvents:function(){var a=this;History.addEvent("change",a.onHistoryChange.bind(a))},parseClipId:function(a){return parseInt(a.split("/").getLast(),10)},sharePopup:function(){window.shareWindowPopup(vimeo.config.clip.id)},checkUrl:function(){var a=this,b=window.location.href;window.location.search.length?window.location.search.substring(1).parseQueryString():null;top!==window.self&&"undefined"!=typeof vimeo&&top.location.hostname!==vimeo.url&&(top.location=window.self.location),(-1!==b.indexOf("#share")||-1!==b.indexOf("#embed")||-1!==b.indexOf("#email"))&&setTimeout(a.sharePopup,1e3),-1!==b.indexOf("#download_source_file")&&(a.source_file=new ClipSourceFileDownload,a.source_file.open()),vimeo.cur_user||-1===b.indexOf("#signin")||Singletonbox.open({url:"/log_in"})},onHistoryChange:function(a){var b=this;History.hasPushState()||a||(a=History.getPathName()),Signal.clip.changed.dispatch(b.parseClipId(a))}});window.ClipController=a}(),window.addEvent("domready",function(){window.clip_controller=new ClipController});